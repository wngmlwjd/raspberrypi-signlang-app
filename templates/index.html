<script>
const form = document.getElementById("recordForm");
const statusEl = document.getElementById("status");
const videoEl = document.getElementById("recordedVideo");
const sourceEl = document.getElementById("videoSource");

form.addEventListener("submit", async (e) => {
    e.preventDefault();
    statusEl.textContent = "녹화 중...";
    videoEl.style.display = "none";

    const res = await fetch("/start_recording", { method: "POST" });
    const data = await res.json();
    statusEl.textContent = data.status;

    setTimeout(async () => {
        const res2 = await fetch("/latest_video");
        const data2 = await res2.json();
        const videoName = data2.filename;
        if (videoName) {
            sourceEl.src = `/recorded/${videoName}`;
            videoEl.load();
            videoEl.style.display = "block";
            statusEl.textContent = "녹화 완료";
        } else {
            statusEl.textContent = "녹화 파일이 없습니다.";
        }
    }, 6000);
});
</script>
